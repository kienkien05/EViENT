import{a as _,j as e}from"./query-By2FkZ5k.js";import{r as t}from"./vendor-Bxm2pvdK.js";import{S as C}from"./Select-B-0jrKDi.js";import{f as g,k as z,c as T,o as F}from"./index-CLvu16Z-.js";import{C as q}from"./Skeleton-DZhbFETI.js";import{T as j,S as M,F as L,X as Q,q as v,m as V,a as k}from"./ui-BgMx_JBB.js";const B={valid:"bg-green-500/10 text-green-600 border-green-500/20",used:"bg-gray-500/10 text-gray-500 border-gray-500/20",cancelled:"bg-red-500/10 text-red-500 border-red-500/20"},H={valid:"Hợp lệ",used:"Đã sử dụng",cancelled:"Đã hủy"};function $(){const[r,y]=t.useState(""),[a,c]=t.useState(""),[l,m]=t.useState(""),[d,x]=t.useState(""),[o,i]=t.useState(!1),n=[a,l,d].filter(Boolean).length,{data:N,isLoading:w}=_({queryKey:["my-tickets",{location:a,date:l,status:d,search:r}],queryFn:()=>F.getMyTickets({limit:100,location:a,date:l,status:d,search:r}).then(s=>s.data.data)}),u=N||[];return e.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2 shrink-0",children:[e.jsx(j,{className:"size-6 text-primary"}),"Vé của tôi"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative w-full sm:w-72",children:[e.jsx(M,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"Tìm theo sự kiện hoặc mã vé...",value:r,onChange:s=>y(s.target.value),className:"w-full pl-9 pr-4 h-10 bg-card border border-input rounded-lg text-sm focus:outline-none focus:ring-1 focus:ring-primary"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>i(!o),className:`h-10 px-4 rounded-lg border flex items-center justify-center gap-2 transition-all w-full sm:w-auto ${o||n>0?"bg-primary/10 border-primary text-primary":"bg-background border-input hover:bg-muted"}`,children:[e.jsx(L,{className:"size-4"}),e.jsx("span",{className:"font-medium hidden sm:inline",children:"Bộ lọc"}),n>0&&e.jsx("span",{className:"flex items-center justify-center size-5 rounded-full bg-primary text-primary-foreground text-xs font-bold",children:n})]}),o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10 hidden sm:block delay-100",onClick:()=>i(!1)}),e.jsxs("div",{className:"absolute right-0 top-full sm:left-auto sm:right-0 mt-2 w-72 sm:w-80 p-4 bg-card border border-border shadow-xl rounded-2xl z-20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-sm",children:"Lọc vé của bạn"}),e.jsx("button",{onClick:()=>i(!1),className:"p-1 rounded-md hover:bg-muted text-muted-foreground transition-colors",children:e.jsx(Q,{className:"size-4"})})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-muted-foreground mb-1 block",children:"Địa điểm"}),e.jsxs("div",{className:"relative",children:[e.jsx(v,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-muted-foreground"}),e.jsx("input",{type:"text",value:a,onChange:s=>c(s.target.value),placeholder:"Nhập địa điểm...",className:"w-full h-10 pl-9 pr-4 rounded-lg border border-input bg-background text-sm focus:ring-2 focus:ring-ring focus:border-transparent outline-none transition-all"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-muted-foreground mb-1 block",children:"Ngày tổ chức"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"date",value:l,onChange:s=>m(s.target.value),className:"w-full h-10 px-3 rounded-lg border border-input bg-background text-sm focus:ring-2 focus:ring-ring focus:border-transparent outline-none transition-all cursor-pointer"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-muted-foreground mb-1 block",children:"Trạng thái vé"}),e.jsx(C,{value:d,onChange:s=>x(s),placeholder:"Tất cả trạng thái",options:[{value:"",label:"Tất cả trạng thái"},{value:"valid",label:"Hợp lệ"},{value:"used",label:"Đã sử dụng"},{value:"cancelled",label:"Đã hủy"}]})]}),n>0&&e.jsx("div",{className:"mt-2 pt-4 border-t border-border",children:e.jsx("button",{onClick:()=>{c(""),m(""),x("")},className:"w-full py-2 text-sm text-red-500 font-medium hover:bg-red-500/10 rounded-lg transition-colors",children:"Xóa bộ lọc"})})]})]})]})]})]})]}),w?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsx(q,{},s))}):u.length===0?e.jsxs("div",{className:"text-center py-20 text-muted-foreground bg-card border border-border rounded-xl",children:[e.jsx(j,{className:"size-12 mx-auto mb-4 opacity-50 text-primary"}),e.jsx("p",{children:r?"Không tìm thấy vé nào phù hợp":"Bạn chưa có vé nào"}),!r&&e.jsx("p",{className:"text-sm mt-1",children:"Hãy mua vé để tham gia sự kiện!"})]}):e.jsx("div",{className:"space-y-4",children:u.map((s,S)=>{var p,h,b,f;return e.jsx(V.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:S*.05},className:"bg-card border border-border rounded-xl overflow-hidden shadow-sm hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"p-4 sm:p-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-base sm:text-lg line-clamp-2",children:((p=s.event)==null?void 0:p.title)||"Sự kiện"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("p",{className:"text-sm text-primary font-medium",children:((h=s.ticket_type)==null?void 0:h.name)||s.ticket_type_name||"Vé tiêu chuẩn"}),s.seat&&e.jsxs("span",{className:"text-xs font-semibold bg-primary/10 text-primary px-2 py-0.5 rounded-md border border-primary/20",children:[s.seat.room," • ",s.seat.row," - Số ",s.seat.number]})]}),e.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-2 mt-3 text-xs sm:text-sm text-muted-foreground",children:[((b=s.event)==null?void 0:b.start_time)&&e.jsxs("span",{className:"flex items-center gap-1.5 bg-muted/50 px-2.5 py-1 rounded-md",children:[e.jsx(k,{className:"size-3.5"}),g(s.event.start_time)]}),((f=s.event)==null?void 0:f.location)&&e.jsxs("span",{className:"flex items-center gap-1.5 bg-muted/50 px-2.5 py-1 rounded-md",children:[e.jsx(v,{className:"size-3.5"}),e.jsx("span",{className:"truncate max-w-[200px]",children:s.event.location})]})]})]}),e.jsx("span",{className:z("shrink-0 text-xs sm:text-sm font-medium px-2.5 py-1 rounded-full border",B[s.status]||"bg-muted text-muted-foreground"),children:H[s.status]||s.status})]}),s.status==="valid"&&s.qr_code&&e.jsx("div",{className:"mt-5 flex justify-center border-t border-dashed border-border pt-5",children:e.jsx("div",{className:"p-3 bg-white rounded-xl shadow-sm border border-border",children:e.jsx("img",{src:s.qr_code,alt:"QR Code",className:"size-32 sm:size-40 object-contain"})})}),s.status==="used"&&s.used_at&&e.jsx("div",{className:"mt-5 flex justify-center border-t border-dashed border-border pt-5",children:e.jsxs("div",{className:"bg-gray-500/10 border border-gray-500/20 text-gray-500 px-6 py-4 rounded-xl text-center",children:[e.jsx("p",{className:"font-semibold",children:"Vé đã được sử dụng"}),e.jsxs("p",{className:"text-sm mt-1",children:["Vào lúc: ",g(s.used_at)]})]})}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row sm:items-center justify-between gap-2 text-sm border-t border-border pt-4 text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:["Mã vé: ",e.jsx("span",{className:"font-mono bg-muted px-2 py-0.5 rounded-md text-foreground",children:s.ticket_code})]}),e.jsx("span",{className:"font-medium text-foreground",children:s.price_at_purchase>0?T(s.price_at_purchase):"Miễn phí"})]})]})},s.id||s.ticket_code)})})]})}export{$ as default};
