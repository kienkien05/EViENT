import{u as Ne,a as te,b as L,j as e}from"./query-By2FkZ5k.js";import{u as ye,r as c}from"./vendor-Bxm2pvdK.js";import{B as h,h as u,r as k,e as we}from"./index-D8pja-1O.js";import{M as $}from"./Modal-DuN345BA.js";import{S as ne}from"./Select-B-0jrKDi.js";import{O as ke,a3 as G,s as ie,S as Se,m as Ce,a4 as Ae,a5 as Te,R as ae,V as Re,a1 as Ie}from"./ui-BgMx_JBB.js";function Ke(){var Z;ye();const S=Ne(),[H,re]=c.useState(""),[le,P]=c.useState(!1),[de,M]=c.useState(!1),[ce,O]=c.useState(!1),[r,v]=c.useState(null),[a,j]=c.useState({name:"",rows:10,seatsPerRow:10}),[f,E]=c.useState([]),[N,B]=c.useState([]),[g,C]=c.useState([]),[d,F]=c.useState("global"),[A,K]=c.useState("all"),[V,J]=c.useState(!1),{data:T,isLoading:oe}=te({queryKey:["admin-rooms"],queryFn:async()=>(await k.getRooms()).data}),R=c.useMemo(()=>{if(!T)return[];if(Array.isArray(T))return T;const s=T;return s.data&&Array.isArray(s.data)?s.data:[]},[T]),{data:I,isLoading:me}=te({queryKey:["admin-events"],queryFn:async()=>(await we.getEvents()).data}),_=c.useMemo(()=>{if(!I)return[];if(Array.isArray(I))return I;const s=I;return s.data&&Array.isArray(s.data)?s.data:s.events&&Array.isArray(s.events)?s.events:[]},[I]),X=L({mutationFn:s=>k.createRoom(s),onSuccess:()=>{S.invalidateQueries({queryKey:["admin-rooms"]}),u.success("ThÃªm phÃ²ng thÃ nh cÃ´ng"),P(!1),p()},onError:()=>u.error("Lá»—i khi thÃªm phÃ²ng")}),D=L({mutationFn:({id:s,payload:n})=>k.updateRoom(s,n),onSuccess:()=>{S.invalidateQueries({queryKey:["admin-rooms"]}),u.success("Cáº­p nháº­t phÃ²ng thÃ nh cÃ´ng")},onError:()=>u.error("Lá»—i khi cáº­p nháº­t phÃ²ng")}),U=L({mutationFn:({roomId:s,seats:n})=>k.updateRoomSeatsBatch(s,n.map(t=>({id:t.id,isActive:t.isActive}))),onSuccess:()=>{S.invalidateQueries({queryKey:["admin-rooms"]}),u.success("Cáº­p nháº­t gháº¿ thÃ nh cÃ´ng")},onError:()=>u.error("Lá»—i khi cáº­p nháº­t gháº¿")}),ue=L({mutationFn:({roomId:s,updates:n})=>k.updateRoomSeatLocksBatch(s,n),onSuccess:()=>{S.invalidateQueries({queryKey:["admin-rooms"]})},onError:()=>u.error("Lá»—i khi cáº­p nháº­t phÃ¢n khu gháº¿")}),W=L({mutationFn:s=>k.deleteRoom(s),onSuccess:()=>{S.invalidateQueries({queryKey:["admin-rooms"]}),u.success("XÃ³a phÃ²ng thÃ nh cÃ´ng"),O(!1),v(null)},onError:()=>u.error("Lá»—i khi xÃ³a phÃ²ng")}),p=()=>{j({name:"",rows:10,seatsPerRow:10}),E([]),B([]),C([]),F("global"),K("all")},he=s=>{v(s),j({name:s.name,rows:s.rows,seatsPerRow:s.seatsPerRow}),E([]),B([]),F("global"),K("all"),s.events?C(s.events.map(n=>n.id)):C([]),M(!0)},xe=s=>{v(s),O(!0)},ge=()=>{if(!a.name.trim()){u.error("Vui lÃ²ng nháº­p tÃªn phÃ²ng");return}if(a.rows<=0||a.seatsPerRow<=0){u.error("KÃ­ch thÆ°á»›c phÃ²ng khÃ´ng há»£p lá»‡");return}X.mutate({name:a.name,rows:a.rows,seats_per_row:a.seatsPerRow,isActive:!0})},fe=async()=>{var s;if(r){if(!a.name.trim()){u.error("Vui lÃ²ng nháº­p tÃªn phÃ²ng");return}J(!0);try{(a.name!==r.name||JSON.stringify(g.sort())!==JSON.stringify((((s=r.events)==null?void 0:s.map(t=>t.id))||[]).sort()))&&await D.mutateAsync({id:r.id,payload:{name:a.name,eventIds:g}}),f.length>0&&await U.mutateAsync({roomId:r.id,seats:f}),N.length>0&&await ue.mutateAsync({roomId:r.id,updates:N}),M(!1),p(),v(null)}catch{}finally{J(!1)}}},pe=()=>{r&&W.mutate(r.id)},be=(s,n)=>{if(b)if(d==="global")E(t=>{if(t.find(i=>i.id===s))return t.filter(i=>i.id!==s);{const i=b.seats.find(m=>m.id===s);return i?[...t,{...i,isActive:!n}]:t}});else{const t=A==="all"?null:A;B(l=>{var m;const i=l.findIndex(o=>o.id===s&&o.eventId===d&&o.ticketTypeId===t);if(i!==-1){const o=[...l];return o.splice(i,1),o}else{const o=b.seats.find(x=>x.id===s),y=(m=o==null?void 0:o.locks)==null?void 0:m.some(x=>x.eventId===d&&(x.ticketTypeId||null)===t);return[...l,{id:s,eventId:d,ticketTypeId:t,action:y?"remove":"add"}]}})}},Y=R.filter(s=>s.name.toLowerCase().includes(H.toLowerCase())),Q={total:(R||[]).length,active:(R||[]).filter(s=>s==null?void 0:s.isActive).length,totalSeats:(R||[]).reduce((s,n)=>{var t;return s+(((t=n==null?void 0:n.seats)==null?void 0:t.length)||0)},0)};if(oe||me)return e.jsx("div",{className:"p-8 flex items-center justify-center",children:"Äang táº£i biá»ƒu Ä‘á»“ phÃ²ng..."});const b=r?(R||[]).find(s=>(s==null?void 0:s.id)===r.id):null,ve=s=>{const n={};return s&&(s.forEach(t=>{if(!t||!t.row||!t.id)return;n[t.row]||(n[t.row]=[]),n[t.row].find(i=>i.id===t.id)||n[t.row].push(t)}),Object.keys(n).forEach(t=>{n[t]&&n[t].sort((l,i)=>((l==null?void 0:l.number)||0)-((i==null?void 0:i.number)||0))})),n},je=r&&(a.name!==r.name||f.length>0||N.length>0||JSON.stringify(g.sort())!==JSON.stringify((((Z=r.events)==null?void 0:Z.map(s=>s.id))||[]).sort()));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Quáº£n lÃ½ phÃ²ng chiáº¿u"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Quáº£n lÃ½ phÃ²ng vÃ  sÆ¡ Ä‘á»“ gháº¿ ngá»“i"})]}),e.jsxs(h,{onClick:()=>{p(),P(!0)},children:[e.jsx(ke,{className:"size-4 mr-2"}),"ThÃªm phÃ²ng"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-card text-card-foreground border rounded-xl overflow-hidden shadow-sm pt-4 p-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"size-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Q.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Tá»•ng phÃ²ng"})]})]})}),e.jsx("div",{className:"bg-card text-card-foreground border rounded-xl overflow-hidden shadow-sm pt-4 p-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"size-5 text-emerald-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Q.active}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Äang hoáº¡t Ä‘á»™ng"})]})]})}),e.jsx("div",{className:"bg-card text-card-foreground border rounded-xl overflow-hidden shadow-sm pt-4 p-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"size-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Q.totalSeats}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Tá»•ng gháº¿"})]})]})})]}),e.jsxs("div",{className:"relative max-w-md my-6",children:[e.jsx(Se,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-5 text-muted-foreground"}),e.jsx("input",{placeholder:"TÃ¬m kiáº¿m phÃ²ng...",value:H,onChange:s=>re(s.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background pl-10 pr-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Y.map((s,n)=>{var i;const t=(s.seats||[]).filter(m=>m.isActive).length,l=(s.seats||[]).length-t;return e.jsx(Ce.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:n*.05},children:e.jsxs("div",{className:`bg-card text-card-foreground border rounded-xl overflow-hidden shadow-sm ${s.isActive?"":"opacity-60"}`,children:[e.jsx("div",{className:"p-6 pb-2 border-b",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("h3",{className:"text-lg font-bold",children:s.name}),e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full border ${s.isActive?"bg-emerald-500/10 text-emerald-600 border-emerald-500/20":"bg-muted text-muted-foreground"}`,children:s.isActive?"Hoáº¡t Ä‘á»™ng":"Táº¯t"})]})}),e.jsxs("div",{className:"p-6 pt-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"p-2 bg-muted rounded",children:[e.jsx("p",{className:"text-muted-foreground",children:"KÃ­ch thÆ°á»›c"}),e.jsxs("p",{className:"font-medium",children:[s.rows," hÃ ng Ã— ",s.seatsPerRow," gháº¿"]})]}),e.jsxs("div",{className:"p-2 bg-muted rounded",children:[e.jsx("p",{className:"text-muted-foreground",children:"Tá»•ng gháº¿"}),e.jsxs("p",{className:"font-medium",children:[((i=s.seats)==null?void 0:i.length)||0," gháº¿"]})]})]}),e.jsxs("div",{className:"flex gap-2 text-xs",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"size-3 bg-emerald-500 rounded"}),"Má»Ÿ: ",t]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"size-3 bg-red-500 rounded"}),"ÄÃ³ng: ",l]})]}),e.jsxs("div",{className:"flex gap-2 justify-end mt-4",children:[e.jsx(h,{variant:"ghost",size:"icon",className:s.isActive?"text-emerald-600 hover:text-emerald-700 hover:bg-emerald-50":"text-muted-foreground hover:bg-muted",onClick:()=>D.mutate({id:s.id,payload:{isActive:!s.isActive}}),title:s.isActive?"Táº¯t phÃ²ng":"Báº­t phÃ²ng",children:s.isActive?e.jsx(Ae,{className:"size-4"}):e.jsx(Te,{className:"size-4"})}),e.jsx(h,{variant:"ghost",size:"icon",className:"hover:bg-accent hover:text-accent-foreground",onClick:()=>he(s),title:"Sá»­a phÃ²ng",children:e.jsx(ae,{className:"size-4"})}),e.jsx(h,{variant:"ghost",size:"icon",className:"text-destructive hover:bg-destructive/10",onClick:()=>xe(s),title:"XÃ³a phÃ²ng",children:e.jsx(Re,{className:"size-4"})})]})]})]})},s.id)})}),Y.length===0&&e.jsxs("div",{className:"py-12 text-center text-muted-foreground",children:[e.jsx(G,{className:"size-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"KhÃ´ng tÃ¬m tháº¥y phÃ²ng nÃ o"})]}),e.jsxs($,{isOpen:le,onClose:()=>{P(!1),p()},title:"ThÃªm phÃ²ng má»›i",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"TÃªn phÃ²ng *"}),e.jsx("input",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:"VD: PhÃ²ng chiáº¿u 1",value:a.name,onChange:s=>j({...a,name:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Sá»‘ hÃ ng"}),e.jsx("input",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",type:"number",min:1,max:26,value:a.rows,onChange:s=>j({...a,rows:parseInt(s.target.value)||1})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Gháº¿ má»—i hÃ ng"}),e.jsx("input",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",type:"number",min:1,max:30,value:a.seatsPerRow,onChange:s=>j({...a,seatsPerRow:parseInt(s.target.value)||1})})]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Tá»•ng: ",a.rows*a.seatsPerRow," gháº¿"]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(h,{variant:"outline",onClick:()=>{P(!1),p()},children:"Há»§y"}),e.jsx(h,{onClick:ge,loading:X.isPending,children:"ThÃªm phÃ²ng"})]})]}),e.jsxs($,{isOpen:de,onClose:()=>{M(!1),p(),v(null)},title:`Chá»‰nh sá»­a phÃ²ng - ${(r==null?void 0:r.name)||""}`,size:"full",children:[b&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6 min-h-[500px]",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"space-y-4 p-4 bg-muted/50 rounded-xl",children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:[e.jsx(ae,{className:"size-5"}),"ThÃ´ng tin phÃ²ng"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"TÃªn phÃ²ng"}),e.jsx("input",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:a.name,onChange:s=>j({...a,name:s.target.value}),placeholder:"Nháº­p tÃªn phÃ²ng"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Sá»‘ hÃ ng"}),e.jsx("div",{className:"font-medium px-3 py-2 bg-background border rounded-md",children:b.rows})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Gháº¿ má»—i hÃ ng"}),e.jsx("div",{className:"font-medium px-3 py-2 bg-background border rounded-md",children:b.seatsPerRow})]})]}),e.jsxs("div",{className:"space-y-2 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Sá»± kiá»‡n sá»­ dá»¥ng phÃ²ng"}),e.jsxs("span",{className:"text-xs text-muted-foreground px-2 py-0.5 bg-muted rounded",children:[g.length," sá»± kiá»‡n"]})]}),e.jsxs("div",{className:"space-y-2 max-h-[150px] overflow-y-auto pr-2 rounded-md border p-2 bg-background custom-scrollbar",children:[_.map(s=>e.jsx("div",{className:"flex items-center justify-between p-2 rounded hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("input",{type:"checkbox",id:`event-${s.id||s._id}`,className:"size-4 rounded border-gray-300 text-primary focus:ring-primary",checked:g.includes(s.id||s._id),onChange:n=>{n.target.checked?C([...g,s.id||s._id]):C(g.filter(t=>t!==(s.id||s._id)))}}),e.jsx("label",{htmlFor:`event-${s.id||s._id}`,className:"text-sm font-medium cursor-pointer w-full truncate",children:s.title})]})},s.id||s._id)),_.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"ChÆ°a cÃ³ sá»± kiá»‡n nÃ o."})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Chá»‰ cÃ¡c sá»± kiá»‡n Ä‘Æ°á»£c chá»n má»›i cÃ³ thá»ƒ sá»­ dá»¥ng phÃ²ng nÃ y Ä‘á»ƒ bÃ¡n vÃ©."})]})]}),e.jsxs("div",{className:"p-4 bg-muted/50 rounded-xl space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium flex items-center gap-2",children:"ChÃº thÃ­ch"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"size-4 bg-emerald-500 rounded"}),e.jsx("span",{children:"Gháº¿ Má»Ÿ"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"size-4 bg-red-500 rounded"}),e.jsx("span",{children:"Gháº¿ Há»ng (KhÃ³a chung)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"size-4 bg-amber-500 rounded"}),e.jsx("span",{children:"KhÃ³a theo Sá»± kiá»‡n/VÃ©"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"size-4 bg-blue-400 opacity-60 rounded"}),e.jsx("span",{children:"KhÃ³a bá»Ÿi NhÃ³m vÃ© khÃ¡c"})]})]})]})]}),e.jsxs("div",{className:"lg:col-span-3 bg-muted/20 border rounded-xl p-6 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(ie,{className:"size-5 text-primary"}),"SÆ¡ Ä‘á»“ gháº¿"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Chá»n cháº¿ Ä‘á»™ KhÃ³a bÃªn dÆ°á»›i vÃ  Click vÃ o gháº¿ Ä‘á»ƒ KhÃ³a/Má»Ÿ (Click LÆ°u thay Ä‘á»•i)"})]}),e.jsxs("span",{className:f.length>0||N.length>0?"text-xs font-semibold px-2 py-1 bg-primary/10 text-primary rounded-full border border-primary/20":"hidden",children:[f.length+N.length," thay Ä‘á»•i chÆ°a lÆ°u"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6 items-center bg-background p-3 rounded-lg border",children:[e.jsxs("div",{className:"flex-1 space-y-1 w-full",children:[e.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:"Cháº¿ Ä‘á»™ khÃ³a gháº¿:"}),e.jsx(ne,{value:d,onChange:s=>{F(s),K("all")},options:[{value:"global",label:"KhÃ³a vÄ©nh viá»…n (PhÃ²ng há»ng)"},...g.map(s=>{const n=_.find(t=>t.id===s||t._id===s);return n?{value:s,label:`ğŸ« ${n.title}`}:null}).filter(Boolean)]})]}),d!=="global"&&e.jsxs("div",{className:"flex-1 space-y-1 w-full",children:[e.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:"Ãp dá»¥ng cho loáº¡i vÃ©:"}),e.jsx(ne,{value:A,onChange:s=>K(s),options:[{value:"all",label:"Táº¥t cáº£ loáº¡i vÃ©"},...(()=>{var n;const s=_.find(t=>t.id===d||t._id===d);return((n=s==null?void 0:s.ticket_types)==null?void 0:n.map(t=>({value:t.id||t._id,label:t.name})))||[]})()]})]})]}),e.jsx("div",{className:"flex-1 min-h-[400px] overflow-auto border bg-background rounded-lg p-8 custom-scrollbar",children:e.jsxs("div",{className:"w-fit mx-auto min-w-full flex flex-col items-center",children:[e.jsxs("div",{className:"w-3/4 max-w-2xl mx-auto mb-12 flex flex-col items-center",children:[e.jsx("div",{className:"w-full h-2 bg-gradient-to-b from-primary/40 to-transparent rounded-t-full shadow-[0_0_20px_rgba(var(--primary),0.3)]"}),e.jsx("div",{className:"w-full h-8 flex justify-center mt-2 border-t border-primary/20 bg-muted/20 backdrop-blur-sm rounded-b-[100%]",children:e.jsx("p",{className:"text-xs font-semibold tracking-[0.2em] text-muted-foreground uppercase pt-1",children:"MÃ n hÃ¬nh gÃ³c"})})]}),e.jsx("div",{className:"flex flex-col gap-3",children:(()=>{const s=ve(b.seats);return Object.keys(s).sort((t,l)=>{const i=parseInt(t.replace(/[^\d]/g,""),10),m=parseInt(l.replace(/[^\d]/g,""),10);return!isNaN(i)&&!isNaN(m)?i-m:t.localeCompare(l)}).map(t=>{const l=s[t];return e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx("span",{className:"w-16 text-center text-sm font-medium text-muted-foreground shrink-0",children:t}),e.jsx("div",{className:"flex gap-2",children:l.map(i=>{var ee,se;const m=f.find(z=>z.id===i.id),o=m?m.isActive:i.isActive;let y=!1;if(d!=="global"){const z=A==="all"?null:A,q=N.find(w=>w.id===i.id&&w.eventId===d&&w.ticketTypeId===z);q?y=q.action==="add":y=((ee=i.locks)==null?void 0:ee.some(w=>w.eventId===d&&(w.ticketTypeId||null)===z))||!1}let x="";return o?d!=="global"&&y?x="bg-amber-500 text-white hover:bg-amber-600 ring-2 ring-primary ring-offset-1":(x="bg-emerald-500 text-white hover:bg-emerald-600",d!=="global"&&!y&&((se=i.locks)!=null&&se.some(q=>q.eventId===d))&&(x="bg-blue-400 text-white hover:bg-blue-500 opacity-60")):x="bg-red-500 text-white hover:bg-red-600",e.jsx("button",{onClick:()=>be(i.id,o),className:`size-8 rounded flex items-center justify-center text-xs font-medium transition-all relative ${x}`,title:`${i.row} - Sá»‘ ${i.number}`,children:i.number},i.id)})})]},t)})})()})]})})]})]}),e.jsx("div",{className:"pt-4 mt-6 border-t w-full",children:e.jsxs("div",{className:"flex w-full justify-between items-center",children:[e.jsx(h,{variant:"ghost",onClick:()=>E([]),disabled:f.length===0,className:"text-muted-foreground hover:text-destructive",children:"KhÃ´i phá»¥c gháº¿"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{variant:"outline",onClick:()=>{M(!1),p(),v(null)},children:"Há»§y"}),e.jsxs(h,{onClick:fe,disabled:!je,className:"min-w-[120px] gap-2",loading:V||D.isPending||U.isPending,children:[e.jsx(Ie,{className:"size-4"}),V?"Äang lÆ°u...":"LÆ°u thay Ä‘á»•i"]})]})]})})]}),e.jsxs($,{isOpen:ce,onClose:()=>O(!1),title:"XÃ³a phÃ²ng",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-muted-foreground",children:["Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n xÃ³a phÃ²ng chiáº¿u ",e.jsx("span",{className:"font-medium text-foreground",children:r==null?void 0:r.name}),"? HÃ nh Ä‘á»™ng nÃ y khÃ´ng thá»ƒ hoÃ n tÃ¡c vÃ  sáº½ xÃ³a toÃ n bá»™ sÆ¡ Ä‘á»“ gháº¿ cÃ¹ng cÃ¡c ticket Ä‘Æ°á»£c liÃªn káº¿t."]})}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(h,{variant:"outline",onClick:()=>O(!1),children:"Há»§y"}),e.jsx(h,{variant:"destructive",onClick:pe,loading:W.isPending,children:"XÃ³a phÃ²ng"})]})]})]})}export{Ke as default};
