import{a as m,j as e}from"./query-By2FkZ5k.js";import{u as N,g as v,f as w,k,e as S,o as q}from"./index-C-Wz0jPL.js";import{g as z,L as x}from"./vendor-Bxm2pvdK.js";import{S as h,a as p,m as g,r as L,q as _,T as K}from"./ui-BgMx_JBB.js";function H(){const[u]=z(),a=u.get("q")||"",{isAuthenticated:d}=N(),{data:t,isLoading:f}=m({queryKey:["search-events",a],queryFn:()=>S.getEvents({search:a,limit:12}).then(s=>s.data),enabled:!!a}),{data:r,isLoading:j}=m({queryKey:["search-tickets",a],queryFn:()=>q.getMyTickets({search:a,limit:20}).then(s=>s.data),enabled:!!a&&d}),i=(t==null?void 0:t.data)||[],l=(r==null?void 0:r.data)||[],b={valid:"bg-green-500/10 text-green-600 border-green-500/20",used:"bg-gray-500/10 text-gray-500 border-gray-500/20",cancelled:"bg-red-500/10 text-red-500 border-red-500/20"},y={valid:"Hợp lệ",used:"Đã sử dụng",cancelled:"Đã hủy"};return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold flex items-center gap-3",children:[e.jsx(h,{className:"size-8 text-primary"}),a?`Kết quả tìm kiếm cho "${a}"`:"Nhập từ khóa để tìm kiếm"]})}),!a&&e.jsxs("div",{className:"text-center py-20 text-muted-foreground bg-card border border-border rounded-xl",children:[e.jsx(h,{className:"size-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Hãy nhập tên sự kiện hoặc mã vé (nếu đã đăng nhập) vào ô tìm kiếm ở trên nhé!"})]}),a&&e.jsxs("div",{className:"flex flex-col gap-12",children:[e.jsxs("section",{children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[e.jsx(p,{className:"size-5 text-primary"})," Sự kiện (",i.length,")"]}),f?e.jsx("p",{className:"text-muted-foreground",children:"Đang tải..."}):i.length===0?e.jsx("p",{className:"text-muted-foreground bg-muted/30 p-4 rounded-lg",children:"Không tìm thấy sự kiện nào khớp với từ khóa."}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:i.map((s,n)=>e.jsx(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:n*.03},children:e.jsxs(x,{to:`/events/${s.id}`,className:"group block rounded-xl border border-border overflow-hidden bg-card hover:shadow-lg transition-all duration-300",children:[e.jsxs("div",{className:"relative aspect-video overflow-hidden",children:[e.jsx("img",{src:v(s.banner_image,{width:500}),alt:s.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500",loading:"lazy",crossOrigin:"anonymous"}),s.is_hot&&e.jsxs("span",{className:"absolute top-2 right-2 bg-orange-500 text-white text-xs font-medium px-2 py-1 rounded-full flex items-center gap-1",children:[e.jsx(L,{className:"size-3"})," Hot"]})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"font-semibold text-sm line-clamp-2 group-hover:text-primary transition-colors",children:s.title}),e.jsxs("div",{className:"mt-2 flex flex-col gap-1 text-xs text-muted-foreground",children:[s.start_time&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(p,{className:"size-3"})," ",w(s.start_time)]}),s.location&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"size-3"})," ",e.jsx("span",{className:"truncate",children:s.location})]})]})]})]})},s.id))})]}),d&&e.jsxs("section",{children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[e.jsx(K,{className:"size-5 text-primary"})," Vé của bạn (",l.length,")"]}),j?e.jsx("p",{className:"text-muted-foreground",children:"Đang tải..."}):l.length===0?e.jsx("p",{className:"text-muted-foreground bg-muted/30 p-4 rounded-lg",children:"Bạn chưa có vé nào khớp với từ khóa này."}):e.jsx("div",{className:"space-y-4 max-w-4xl",children:l.map((s,n)=>{var o,c;return e.jsx(g.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:n*.05},className:"bg-card border border-border rounded-xl overflow-hidden shadow-sm flex flex-col sm:flex-row",children:e.jsx("div",{className:"p-4 sm:p-5 flex-1 relative",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"font-mono text-xs text-muted-foreground mb-1 mt-1",children:["Mã vé: ",e.jsx("span",{className:"text-foreground font-semibold",children:s.ticket_code})]}),e.jsx("h3",{className:"font-semibold text-base sm:text-lg line-clamp-2 text-primary hover:underline cursor-pointer",children:e.jsx(x,{to:"/my-tickets",children:((o=s.event)==null?void 0:o.title)||"Sự kiện"})}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("p",{className:"text-sm font-medium",children:((c=s.ticket_type)==null?void 0:c.name)||"Vé tiêu chuẩn"}),s.seat&&e.jsxs("span",{className:"text-xs font-semibold bg-primary/10 text-primary px-2 py-0.5 rounded-md border border-primary/20",children:[s.seat.room," • Ghế ",s.seat.row,s.seat.number]})]})]}),e.jsx("div",{className:"shrink-0 flex flex-col items-end",children:e.jsx("span",{className:k("text-[10px] sm:text-xs font-medium px-2 sm:px-3 py-1 bg-muted rounded-full border",b[s.status]),children:y[s.status]||s.status})})]})})},s.id)})})]})]})]})}export{H as default};
