import{j as e,u as je,a as Q,b as O}from"./query-By2FkZ5k.js";import{r as l,b as Ne}from"./vendor-Bxm2pvdK.js";import{n as ye,p as ee,k as E,B as k,f as _e,h as w,e as R,j as G,r as ke}from"./index-D8pja-1O.js";import{M as we}from"./Modal-DuN345BA.js";import{S as I}from"./Select-B-0jrKDi.js";import{T as Se}from"./Skeleton-DwcWZSGh.js";import{O as X,S as Ce,R as Y,V as $,a as Te,T as te,D as se,h as ne,Y as A,_ as Z,X as ze,l as Pe}from"./ui-BgMx_JBB.js";function Ee(s,r,{checkForDefaultPrevented:i=!0}={}){return function(a){if(s==null||s(a),i===!1||!a.defaultPrevented)return r==null?void 0:r(a)}}function Re(s,r=[]){let i=[];function u(m,c){const d=l.createContext(c),p=i.length;i=[...i,c];const f=h=>{var y;const{scope:b,children:g,...v}=h,j=((y=b==null?void 0:b[s])==null?void 0:y[p])||d,z=l.useMemo(()=>v,Object.values(v));return e.jsx(j.Provider,{value:z,children:g})};f.displayName=m+"Provider";function o(h,b){var j;const g=((j=b==null?void 0:b[s])==null?void 0:j[p])||d,v=l.useContext(g);if(v)return v;if(c!==void 0)return c;throw new Error(`\`${h}\` must be used within \`${m}\``)}return[f,o]}const a=()=>{const m=i.map(c=>l.createContext(c));return function(d){const p=(d==null?void 0:d[s])||m;return l.useMemo(()=>({[`__scope${s}`]:{...d,[s]:p}}),[d,p])}};return a.scopeName=s,[u,qe(a,...r)]}function qe(...s){const r=s[0];if(s.length===1)return r;const i=()=>{const u=s.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(m){const c=u.reduce((d,{useScope:p,scopeName:f})=>{const h=p(m)[`__scope${f}`];return{...d,...h}},{});return l.useMemo(()=>({[`__scope${r.scopeName}`]:c}),[c])}};return i.scopeName=r.scopeName,i}var re=globalThis!=null&&globalThis.document?l.useLayoutEffect:()=>{},Be=Ne[" useInsertionEffect ".trim().toString()]||re;function Me({prop:s,defaultProp:r,onChange:i=()=>{},caller:u}){const[a,m,c]=Oe({defaultProp:r,onChange:i}),d=s!==void 0,p=d?s:a;{const o=l.useRef(s!==void 0);l.useEffect(()=>{const h=o.current;h!==d&&console.warn(`${u} is changing from ${h?"controlled":"uncontrolled"} to ${d?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),o.current=d},[d,u])}const f=l.useCallback(o=>{var h;if(d){const b=Ie(o)?o(s):o;b!==s&&((h=c.current)==null||h.call(c,b))}else m(o)},[d,s,m,c]);return[p,f]}function Oe({defaultProp:s,onChange:r}){const[i,u]=l.useState(s),a=l.useRef(i),m=l.useRef(r);return Be(()=>{m.current=r},[r]),l.useEffect(()=>{var c;a.current!==i&&((c=m.current)==null||c.call(m,i),a.current=i)},[i,a]),[i,u,m]}function Ie(s){return typeof s=="function"}function $e(s){const r=l.useRef({value:s,previous:s});return l.useMemo(()=>(r.current.value!==s&&(r.current.previous=r.current.value,r.current.value=s),r.current.previous),[s])}function Ae(s){const[r,i]=l.useState(void 0);return re(()=>{if(s){i({width:s.offsetWidth,height:s.offsetHeight});const u=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const m=a[0];let c,d;if("borderBoxSize"in m){const p=m.borderBoxSize,f=Array.isArray(p)?p[0]:p;c=f.inlineSize,d=f.blockSize}else c=s.offsetWidth,d=s.offsetHeight;i({width:c,height:d})});return u.observe(s,{box:"border-box"}),()=>u.unobserve(s)}else i(void 0)},[s]),r}function Ve(s){const r=De(s),i=l.forwardRef((u,a)=>{const{children:m,...c}=u,d=l.Children.toArray(m),p=d.find(Fe);if(p){const f=p.props.children,o=d.map(h=>h===p?l.Children.count(f)>1?l.Children.only(null):l.isValidElement(f)?f.props.children:null:h);return e.jsx(r,{...c,ref:a,children:l.isValidElement(f)?l.cloneElement(f,void 0,o):null})}return e.jsx(r,{...c,ref:a,children:m})});return i.displayName=`${s}.Slot`,i}function De(s){const r=l.forwardRef((i,u)=>{const{children:a,...m}=i;if(l.isValidElement(a)){const c=Ke(a),d=Ue(m,a.props);return a.type!==l.Fragment&&(d.ref=u?ye(u,c):c),l.cloneElement(a,d)}return l.Children.count(a)>1?l.Children.only(null):null});return r.displayName=`${s}.SlotClone`,r}var Le=Symbol("radix.slottable");function Fe(s){return l.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===Le}function Ue(s,r){const i={...r};for(const u in r){const a=s[u],m=r[u];/^on[A-Z]/.test(u)?a&&m?i[u]=(...d)=>{const p=m(...d);return a(...d),p}:a&&(i[u]=a):u==="style"?i[u]={...a,...m}:u==="className"&&(i[u]=[a,m].filter(Boolean).join(" "))}return{...s,...i}}function Ke(s){var u,a;let r=(u=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:u.get,i=r&&"isReactWarning"in r&&r.isReactWarning;return i?s.ref:(r=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,i=r&&"isReactWarning"in r&&r.isReactWarning,i?s.props.ref:s.props.ref||s.ref)}var We=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ie=We.reduce((s,r)=>{const i=Ve(`Primitive.${r}`),u=l.forwardRef((a,m)=>{const{asChild:c,...d}=a,p=c?i:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(p,{...d,ref:m})});return u.displayName=`Primitive.${r}`,{...s,[r]:u}},{}),M="Switch",[He]=Re(M),[Qe,Ge]=He(M),ae=l.forwardRef((s,r)=>{const{__scopeSwitch:i,name:u,checked:a,defaultChecked:m,required:c,disabled:d,value:p="on",onCheckedChange:f,form:o,...h}=s,[b,g]=l.useState(null),v=ee(r,C=>g(C)),j=l.useRef(!1),z=b?o||!!b.closest("form"):!0,[y,q]=Me({prop:a,defaultProp:m??!1,onChange:f,caller:M});return e.jsxs(Qe,{scope:i,checked:y,disabled:d,children:[e.jsx(ie.button,{type:"button",role:"switch","aria-checked":y,"aria-required":c,"data-state":de(y),"data-disabled":d?"":void 0,disabled:d,value:p,...h,ref:v,onClick:Ee(s.onClick,C=>{q(B=>!B),z&&(j.current=C.isPropagationStopped(),j.current||C.stopPropagation())})}),z&&e.jsx(ce,{control:b,bubbles:!j.current,name:u,value:p,checked:y,required:c,disabled:d,form:o,style:{transform:"translateX(-100%)"}})]})});ae.displayName=M;var oe="SwitchThumb",le=l.forwardRef((s,r)=>{const{__scopeSwitch:i,...u}=s,a=Ge(oe,i);return e.jsx(ie.span,{"data-state":de(a.checked),"data-disabled":a.disabled?"":void 0,...u,ref:r})});le.displayName=oe;var Xe="SwitchBubbleInput",ce=l.forwardRef(({__scopeSwitch:s,control:r,checked:i,bubbles:u=!0,...a},m)=>{const c=l.useRef(null),d=ee(c,m),p=$e(i),f=Ae(r);return l.useEffect(()=>{const o=c.current;if(!o)return;const h=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(h,"checked").set;if(p!==i&&g){const v=new Event("click",{bubbles:u});g.call(o,i),o.dispatchEvent(v)}},[p,i,u]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i,...a,tabIndex:-1,ref:d,style:{...a.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});ce.displayName=Xe;function de(s){return s?"checked":"unchecked"}var ue=ae,Ye=le;const me=l.forwardRef(({className:s,...r},i)=>e.jsx(ue,{className:E("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...r,ref:i,children:e.jsx(Ye,{className:E("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));me.displayName=ue.displayName;const J={title:"",description:"",content:"",location:"",category:"",status:"draft",start_time:"",end_time:"",banner_image:"",sub_banners:[],show_sub_banners:!0,max_tickets_per_user:10,room_ids:[],ticket_types:[]},Ze={name:"",description:"",price:0,original_price:0,quantity_total:100,quantity_sold:0,max_per_user:-1},Je=[{id:"info",label:"Thông tin",icon:Te},{id:"tickets",label:"Loại vé",icon:te},{id:"rooms",label:"Phòng",icon:se},{id:"sub_banners",label:"Ảnh phụ",icon:ne}];function ot(){const[s,r]=l.useState(""),[i,u]=l.useState(1),[a,m]=l.useState(!1),[c,d]=l.useState(null),[p,f]=l.useState("info"),[o,h]=l.useState({...J}),[b,g]=l.useState(!1),v=je(),{data:j,isLoading:z}=Q({queryKey:["admin","events",{search:s,page:i}],queryFn:()=>R.getEvents({search:s,page:i,limit:20,status:""}).then(t=>t.data)}),{data:y}=Q({queryKey:["rooms"],queryFn:()=>ke.getRooms().then(t=>t.data)}),q=(y==null?void 0:y.data)||[],C=O({mutationFn:t=>R.deleteEvent(t),onSuccess:()=>{v.invalidateQueries({queryKey:["admin","events"]}),w.success("Đã xóa sự kiện")}}),B=O({mutationFn:t=>R.updateEvent(t.id,{status:t.status}),onSuccess:()=>{v.invalidateQueries({queryKey:["admin","events"]}),w.success("Đã cập nhật trạng thái sự kiện")}}),V=O({mutationFn:t=>c?R.updateEvent(c.id,t):R.createEvent(t),onSuccess:t=>{v.invalidateQueries({queryKey:["admin","events"]}),m(!1),w.success(c?"Đã cập nhật sự kiện":"Đã tạo sự kiện")}}),he=()=>{d(null),h({...J}),f("info"),m(!0)},D=t=>{d(t),h({title:t.title||"",description:t.description||"",content:t.content||"",location:t.location||"",category:t.category||"",status:t.status||"draft",start_time:t.start_time?new Date(t.start_time).toISOString().slice(0,16):"",end_time:t.end_time?new Date(t.end_time).toISOString().slice(0,16):"",banner_image:t.banner_image||"",sub_banners:t.sub_banners||[],show_sub_banners:t.show_sub_banners!==!1,max_tickets_per_user:t.max_tickets_per_user||10,room_ids:t.room_ids||[],ticket_types:(t.ticket_types||[]).map(n=>({id:n.id,name:n.name||"",description:n.description||"",price:n.price||0,original_price:n.original_price||0,quantity_total:n.quantity_total??0,quantity_sold:n.quantity_sold||0,max_per_user:n.max_per_user??t.max_tickets_per_user??10}))}),f("info"),m(!0)},pe=()=>{if(!o.title.trim()){w.error("Vui lòng nhập tên sự kiện"),f("info");return}V.mutate(o)},L=async t=>{var x,N;const n=(x=t.target.files)==null?void 0:x[0];if(n){g(!0);try{const _=await G.upload(n,"events");(N=_.data)!=null&&N.success&&(h(P=>({...P,banner_image:_.data.data.url})),w.success("Tải ảnh lên thành công"))}catch{w.error("Lỗi tải ảnh")}finally{g(!1)}}},xe=async t=>{var x,N,_,P,U,K;const n=(x=t.target.files)==null?void 0:x[0];if(n){g(!0);try{const S=await G.upload(n,"events"),W=((_=(N=S.data)==null?void 0:N.data)==null?void 0:_.url)||((P=S.data)==null?void 0:P.url);W?(h(H=>({...H,sub_banners:[...H.sub_banners,W]})),w.success("Tải ảnh phụ lên thành công")):(console.error("Upload response:",S.data),w.error("Upload thành công nhưng không nhận được URL ảnh"))}catch(S){console.error("Sub-banner upload error:",S),w.error(((K=(U=S==null?void 0:S.response)==null?void 0:U.data)==null?void 0:K.message)||"Lỗi tải ảnh phụ")}finally{g(!1),t.target.value=""}}},fe=t=>{h(n=>({...n,sub_banners:n.sub_banners.filter((x,N)=>N!==t)}))},be=()=>{h(t=>({...t,ticket_types:[...t.ticket_types,{...Ze}]}))},ge=t=>{h(n=>({...n,ticket_types:n.ticket_types.filter((x,N)=>N!==t)}))},T=(t,n,x)=>{h(N=>({...N,ticket_types:N.ticket_types.map((_,P)=>P===t?{..._,[n]:x}:_)}))},ve=t=>{h(n=>({...n,room_ids:n.room_ids.includes(t)?n.room_ids.filter(x=>x!==t):[...n.room_ids,t]}))},F=(j==null?void 0:j.data)||[];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Quản lý sự kiện"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:e.jsxs(k,{onClick:he,className:"gap-2 text-xs sm:text-sm",children:[e.jsx(X,{className:"size-4"})," Tạo sự kiện"]})})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(Ce,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"Tìm kiếm...",value:s,onChange:t=>{r(t.target.value),u(1)},className:"w-full h-10 pl-10 pr-4 rounded-lg border border-input bg-background outline-none focus:ring-2 focus:ring-ring text-sm"})]}),e.jsx("div",{className:"hidden md:block bg-card border border-border rounded-xl overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border bg-muted/50",children:[e.jsx("th",{className:"text-left p-3 font-medium",children:"Tên sự kiện"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Danh mục"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Trạng thái"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Ngày bắt đầu"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Thao tác"})]})}),e.jsx("tbody",{children:z?Array.from({length:5}).map((t,n)=>e.jsx(Se,{},n)):F.map(t=>e.jsxs("tr",{className:"border-b border-border last:border-0 hover:bg-muted/30",children:[e.jsx("td",{className:"p-3 font-medium max-w-[200px] truncate",children:e.jsx("div",{className:"flex items-center gap-1.5",children:t.title})}),e.jsx("td",{className:"p-3 text-muted-foreground",children:t.category||"—"}),e.jsx("td",{className:"p-3",children:e.jsx(I,{value:t.status,onChange:n=>B.mutate({id:t.id,status:n}),className:"w-32",options:[{value:"draft",label:"Nháp"},{value:"published",label:"Đã đăng"},{value:"cancelled",label:"Đã hủy"},{value:"completed",label:"Hoàn thành"}]})}),e.jsx("td",{className:"p-3 text-muted-foreground",children:t.start_time?_e(t.start_time):"—"}),e.jsx("td",{className:"p-3 text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(k,{variant:"ghost",size:"icon",onClick:()=>D(t),children:e.jsx(Y,{className:"size-4"})}),e.jsx(k,{variant:"ghost",size:"icon",onClick:()=>C.mutate(t.id),children:e.jsx($,{className:"size-4 text-destructive"})})]})})]},t.id))})]})}),e.jsx("div",{className:"md:hidden space-y-3",children:F.map(t=>e.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-medium text-sm truncate flex items-center gap-1",children:t.title}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:t.category||"Chưa phân loại"})]}),e.jsx(I,{value:t.status,onChange:n=>B.mutate({id:t.id,status:n}),className:"w-32",options:[{value:"draft",label:"Nháp"},{value:"published",label:"Đã đăng"},{value:"cancelled",label:"Đã hủy"},{value:"completed",label:"Hoàn thành"}]})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsxs(k,{variant:"outline",size:"sm",onClick:()=>D(t),className:"flex-1 gap-1",children:[e.jsx(Y,{className:"size-3"})," Sửa"]}),e.jsx(k,{variant:"outline",size:"sm",onClick:()=>C.mutate(t.id),className:"gap-1",children:e.jsx($,{className:"size-3 text-destructive"})})]})]},t.id))}),e.jsxs(we,{isOpen:a,onClose:()=>m(!1),title:c?"Sửa sự kiện":"Tạo sự kiện",size:"lg",children:[e.jsx("div",{className:"flex border-b border-border -mx-6 px-6 mb-5 overflow-x-auto",children:Je.map(t=>e.jsxs("button",{onClick:()=>f(t.id),className:E("flex items-center gap-1.5 px-4 py-2.5 text-sm font-medium border-b-2 transition-colors whitespace-nowrap",p===t.id?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"),children:[e.jsx(t.icon,{className:"size-4"}),t.label,t.id==="tickets"&&o.ticket_types.length>0&&e.jsx("span",{className:"ml-1 text-xs bg-primary/10 text-primary rounded-full px-1.5",children:o.ticket_types.length}),t.id==="rooms"&&o.room_ids.length>0&&e.jsx("span",{className:"ml-1 text-xs bg-primary/10 text-primary rounded-full px-1.5",children:o.room_ids.length}),t.id==="sub_banners"&&o.sub_banners.length>0&&e.jsx("span",{className:"ml-1 text-xs bg-primary/10 text-primary rounded-full px-1.5",children:o.sub_banners.length})]},t.id))}),e.jsxs("div",{className:"min-h-[300px]",children:[p==="info"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tên sự kiện *"}),e.jsx("input",{value:o.title,onChange:t=>h(n=>({...n,title:t.target.value})),className:"w-full h-10 px-3 rounded-lg border border-input bg-background outline-none focus:ring-2 focus:ring-ring text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Danh mục"}),e.jsx("input",{value:o.category,onChange:t=>h(n=>({...n,category:t.target.value})),className:"w-full h-10 px-3 rounded-lg border border-input bg-background outline-none focus:ring-2 focus:ring-ring text-sm",placeholder:"Âm nhạc, Thể thao, ..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Địa điểm"}),e.jsx("input",{value:o.location,onChange:t=>h(n=>({...n,location:t.target.value})),className:"w-full h-10 px-3 rounded-lg border border-input bg-background outline-none focus:ring-2 focus:ring-ring text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Bắt đầu"}),e.jsx("input",{type:"datetime-local",value:o.start_time,onChange:t=>h(n=>({...n,start_time:t.target.value})),className:"w-full h-10 px-3 rounded-lg border border-input bg-background outline-none focus:ring-2 focus:ring-ring text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Kết thúc"}),e.jsx("input",{type:"datetime-local",value:o.end_time,onChange:t=>h(n=>({...n,end_time:t.target.value})),className:"w-full h-10 px-3 rounded-lg border border-input bg-background outline-none focus:ring-2 focus:ring-ring text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Mô tả"}),e.jsx("textarea",{value:o.description,onChange:t=>h(n=>({...n,description:t.target.value})),rows:3,className:"w-full px-3 py-2 rounded-lg border border-input bg-background outline-none focus:ring-2 focus:ring-ring text-sm resize-none"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ảnh Banner"}),o.banner_image?e.jsxs("div",{className:"relative group rounded-lg overflow-hidden border border-border",children:[e.jsx("img",{src:o.banner_image,className:"w-full h-32 object-cover",alt:"Banner"}),e.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:e.jsxs("label",{className:"cursor-pointer text-white flex items-center gap-1 text-sm hover:underline",children:[e.jsx(A,{className:"size-4"})," Đổi ảnh",e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:L})]})})]}):e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed border-border rounded-lg cursor-pointer hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[b?e.jsx(Z,{className:"size-6 text-muted-foreground animate-spin mb-2"}):e.jsx(A,{className:"size-6 text-muted-foreground mb-2"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Nhấn để tải ảnh lên"})]}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",disabled:b,onChange:L})]})]})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Trạng thái (Khởi tạo)"}),e.jsx(I,{value:o.status,onChange:t=>h(n=>({...n,status:t})),options:[{value:"draft",label:"Nháp"},{value:"published",label:"Đã đăng"},{value:"cancelled",label:"Đã hủy"},{value:"completed",label:"Hoàn thành"}]})]})})]}),p==="tickets"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:o.ticket_types.length===0?"Chưa có loại vé nào":`${o.ticket_types.length} loại vé`}),e.jsxs(k,{size:"sm",variant:"outline",onClick:be,className:"gap-1.5",children:[e.jsx(X,{className:"size-3.5"})," Thêm loại vé"]})]}),o.ticket_types.map((t,n)=>e.jsxs("div",{className:"border border-border rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:["Loại vé #",n+1]}),e.jsx("button",{onClick:()=>ge(n),className:"text-muted-foreground hover:text-destructive transition-colors",children:e.jsx(ze,{className:"size-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium mb-1 text-muted-foreground",children:"Tên vé *"}),e.jsx("input",{value:t.name,onChange:x=>T(n,"name",x.target.value),placeholder:"VD: Vé thường, VIP, ...",className:"w-full h-9 px-3 rounded-lg border border-input bg-background outline-none focus:ring-2 focus:ring-ring text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 text-muted-foreground",children:"Giá (VNĐ) *"}),e.jsx("input",{type:"number",min:0,value:t.price,onChange:x=>T(n,"price",Number(x.target.value)),className:"w-full h-9 px-3 rounded-lg border border-input bg-background outline-none focus:ring-2 focus:ring-ring text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 text-muted-foreground",children:"Giá gốc (VNĐ)"}),e.jsx("input",{type:"number",min:0,value:t.original_price,onChange:x=>T(n,"original_price",Number(x.target.value)),className:"w-full h-9 px-3 rounded-lg border border-input bg-background outline-none focus:ring-2 focus:ring-ring text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 text-muted-foreground",children:"Số lượng phát hành"}),e.jsx("input",{type:"number",min:-1,value:t.quantity_total,onChange:x=>T(n,"quantity_total",Number(x.target.value)),className:"w-full h-9 px-3 rounded-lg border border-input bg-background outline-none focus:ring-2 focus:ring-ring text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 text-muted-foreground",children:"Đã bán"}),e.jsx("input",{type:"number",min:0,value:t.quantity_sold,onChange:x=>T(n,"quantity_sold",Math.max(0,Number(x.target.value))),className:"w-full h-9 px-3 rounded-lg border border-input bg-background outline-none focus:ring-2 focus:ring-ring text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 text-muted-foreground",children:"Vé còn lại"}),e.jsx("div",{className:"h-9 px-3 rounded-lg border border-input bg-muted/50 flex items-center text-sm font-medium",children:t.quantity_total===-1?e.jsx("span",{className:"text-green-500",children:"Không giới hạn"}):e.jsx("span",{className:t.quantity_total-t.quantity_sold<=0?"text-destructive":"",children:t.quantity_total-t.quantity_sold})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 text-muted-foreground",children:"Số lượt mua tối đa mỗi người"}),e.jsx("input",{type:"number",min:-1,value:t.max_per_user,onChange:x=>T(n,"max_per_user",Number(x.target.value)),className:"w-full h-9 px-3 rounded-lg border border-input bg-background outline-none focus:ring-2 focus:ring-ring text-sm"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium mb-1 text-muted-foreground",children:"Mô tả vé"}),e.jsx("input",{value:t.description,onChange:x=>T(n,"description",x.target.value),className:"w-full h-9 px-3 rounded-lg border border-input bg-background outline-none focus:ring-2 focus:ring-ring text-sm"})]})]})]},n)),o.ticket_types.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(te,{className:"size-10 mx-auto mb-2 opacity-30"}),e.jsx("p",{className:"text-sm",children:'Nhấn "Thêm loại vé" để tạo vé cho sự kiện'})]})]}),p==="rooms"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Chọn phòng cho sự kiện (",o.room_ids.length," đã chọn)"]}),q.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(se,{className:"size-10 mx-auto mb-2 opacity-30"}),e.jsx("p",{className:"text-sm",children:"Chưa có phòng nào. Hãy tạo phòng trước."})]}):e.jsx("div",{className:"space-y-2",children:q.map(t=>{const n=o.room_ids.includes(t.id);return e.jsxs("button",{onClick:()=>ve(t.id),className:E("w-full flex items-center justify-between p-3 rounded-lg border text-left transition-colors",n?"border-primary bg-primary/5":"border-border hover:bg-muted/50"),children:[e.jsxs("div",{children:[e.jsx("p",{className:E("text-sm font-medium",n&&"text-primary"),children:t.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.rows," hàng × ",t.seats_per_row," ghế = ",t.rows*t.seats_per_row," chỗ"]})]}),e.jsx("div",{className:E("size-5 rounded-full border-2 flex items-center justify-center shrink-0",n?"border-primary bg-primary":"border-muted-foreground/30"),children:n&&e.jsx(Pe,{className:"size-3 text-white"})})]},t.id)})})]}),p==="sub_banners"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Ảnh phụ trình chiếu"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:"Tải lên các ảnh phụ cho sự kiện, sẽ được hiển thị dạng slider trên trang chi tiết sự kiện."})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm",children:"Hiển thị slider:"}),e.jsx(me,{checked:o.show_sub_banners,onCheckedChange:t=>h({...o,show_sub_banners:t})})]}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsxs("span",{className:"inline-flex items-center gap-1.5 h-8 px-3 text-xs font-medium rounded-lg shadow-sm border border-input bg-background hover:bg-muted hover:text-accent-foreground transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",children:[b?e.jsx(Z,{className:"size-3.5 animate-spin"}):e.jsx(A,{className:"size-3.5"})," Tải ảnh lên"]}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",disabled:b,onChange:xe})]})]})]}),o.sub_banners.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground border-2 border-dashed border-border rounded-lg",children:[e.jsx(ne,{className:"size-10 mx-auto mb-2 opacity-30"}),e.jsx("p",{className:"text-sm",children:"Chưa có ảnh phụ nào"})]}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:o.sub_banners.map((t,n)=>e.jsxs("div",{className:"relative group rounded-lg overflow-hidden border border-border aspect-video",children:[e.jsx("img",{src:t,className:"w-full h-full object-cover",alt:`Sub-banner ${n+1}`}),e.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx(k,{size:"icon",variant:"destructive",onClick:()=>fe(n),className:"size-8 rounded-full",children:e.jsx($,{className:"size-4"})})})]},n))})]})]}),e.jsxs("div",{className:"mt-5 flex gap-3",children:[e.jsx(k,{onClick:pe,loading:V.isPending,className:"flex-1",children:c?"Cập nhật":"Tạo sự kiện"}),e.jsx(k,{variant:"outline",onClick:()=>m(!1),className:"flex-1",children:"Hủy"})]})]})]})}export{ot as default};
